<apex:page standardController="Case" showHeader="true" sidebar="true" extensions="FS_LM_CaseEditPageController" >
    
    <apex:form id="LMForm">      
        <apex:sectionHeader title="Case Edit" subtitle="New Case" rendered="{!newcs}"/>
        <apex:sectionHeader title="Case Edit" subtitle="{!cs.CaseNumber}" rendered="{!editcs}"/>
        <apex:pageBlock id="pgBlock" mode="edit" title="Case Edit">
            <apex:pageBlockButtons location="both">
                <apex:commandButton value="Save" action="{!saveCase}" />
                <apex:commandButton value="Save & New" action="{!saveNew}"/>
                <apex:commandButton value="Cancel" action="{!Cancel}"/>
            </apex:pageBlockButtons>
            <apex:pageMessages id="showmsg"></apex:pageMessages>
            <apex:pageBlockSection id="pgBlockSectionCaseInfo" title="Case Information" collapsible="false" columns="2" >
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Case Number</apex:outputLabel>                    
                    <apex:inputField id="caseNumber" value="{!cs.CaseNumber}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Case Owner</apex:outputLabel>                    
                    <apex:outputText id="caseOwner" value="{!CaseOwner}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Case Type</apex:outputLabel>                    
                    <apex:inputField id="caseType" value="{!cs.FS_New_Case_Type__c}" required="true"/>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem rendered="{!editcs}">
                    <apex:outputLabel >Case Record Type</apex:outputLabel>                    
                    <apex:outputField id="caseRT" value="{!cs.recordTypeId}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem rendered="{!newcs}">
                    <apex:outputLabel >Case Record Type</apex:outputLabel>                    
                    <apex:outputText id="caseRT" value="Linkage Management" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Issue Name</apex:outputLabel>                    
                    <apex:inputField id="caseIssuename" value="{!cs.Issue_Name__c}" required="true"/>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Case Age</apex:outputLabel>                    
                    <apex:outputField id="caseAge" value="{!cs.Case_Age_Days__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Priority</apex:outputLabel>
                    <apex:inputField id="casePriority" value="{!cs.Priority}" />
                </apex:pageBlockSectionItem> 
                <apex:pageBlockSectionItem >
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Status</apex:outputLabel>
                    <apex:inputField id="caseStatus" value="{!cs.Status}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem > </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Sub-Status</apex:outputLabel>
                    <apex:inputField id="caseSubStatus" value="{!cs.LM_Sub_Status__c}" />
                </apex:pageBlockSectionItem>
            </apex:pageBlockSection>
            <apex:pageBlockSection id="pgBlockSectionAccInfo" title="Account Information" collapsible="false" columns="2">
                <apex:pageBlockSection columns="1">
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel >To Account</apex:outputLabel>    
                        <apex:actionRegion >
                            <apex:inputField id="caseToACN" value="{!cs.To_Account__c}" required="true" >
                                <apex:actionSupport event="onchange" action="{!toACNODdetails}" reRender="disptb1,accDetails1,showmsg" />
                            </apex:inputField>
                        </apex:actionRegion>                
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem ></apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:pageBlockTable value="{!ToAcnOD}" var="odval" id="disptb1">
                            <apex:column headerValue="Serial Number" value="{!odval.FS_Serial_Number__c}"/>
                            <apex:column headerValue="Outlet Dispenser">
                            <apex:outputLink value="/{!odval.id}" target="_blank">
                            {!odval.Name}
                            </apex:outputLink>
                            </apex:column>
                            <apex:column headerValue="Active/Inactive" value="{!odval.FS_IsActive__c}"/>
                            <apex:column headerValue="Status" value="{!odval.FS_Status__c}"/>
                        </apex:pageBlockTable>
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>
                <apex:pageBlockSection columns="1" id="accDetails1">
                    <apex:pageBlockSectionItem id="acname">
                        <apex:outputLabel >Account Name</apex:outputLabel>                    
                        <apex:outputField id="Accountname" value="{!ToACN.Name}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel >ACN</apex:outputLabel>
                        <apex:outputField id="ACNno" value="{!ToACN.Outlet_ACN__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel >Address</apex:outputLabel>                    
                        <apex:outputField id="address" value="{!ToACN.ShippingStreet}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem labelTitle="Address">
                        <apex:outputLabel >City</apex:outputLabel>                    
                        <apex:outputText id="AccCity" value="{!ToACN.ShippingCity}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel >State</apex:outputLabel>                    
                        <apex:outputText id="AccState" value="{!ToACN.ShippingState}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel >Country</apex:outputLabel>                    
                        <apex:outputText id="AccCountry" value="{!ToACN.ShippingCountry}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel >Zip</apex:outputLabel>                    
                        <apex:outputText id="AccZip" value="{!ToACN.ShippingPostalCode}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem ></apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem > 
                        <apex:outputLabel >NOTE: </apex:outputLabel>
                        <apex:outputText id="note1" value="Dispenser list will auto-populate as dispensers get re-linked."></apex:outputText>
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>
                <apex:pageBlockSection columns="1">
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel >From Account</apex:outputLabel>    
                        <apex:actionRegion >
                            <apex:inputField id="caseFromACN" value="{!cs.From_Account__c}" >
                                <apex:actionSupport event="onchange" action="{!fromACNODdetailswrpr}" reRender="disptb2,accDetails2,showmsg" />
                            </apex:inputField>
                        </apex:actionRegion>                
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem ></apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem dataTitle="Dispensers">
                        <apex:pageBlockTable value="{!ODList}" var="odvl" id="disptb2">
                            <apex:column >
                                <apex:inputCheckbox value="{!odvl.selected}" />                             
                            </apex:column>
                            <apex:column headerValue="Serial Number" value="{!odvl.od.FS_Serial_Number__c}"/>
                             <apex:column headerValue="Outlet Dispenser"> 
                             <apex:outputLink value="/{!odvl.od.id}" target="_blank">
                             {!odvl.od.Name}
                             </apex:outputLink>
                             </apex:column>
                            <apex:column headerValue="Active/Inactive" value="{!odvl.od.FS_IsActive__c}"/>
                            <apex:column headerValue="Status" value="{!odvl.od.FS_Status__c}"/>
                        </apex:pageBlockTable>
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>
                <apex:pageBlockSection columns="1"  id="accDetails2">
                    <apex:pageBlockSectionItem id="acname">
                        <apex:outputLabel >Account Name</apex:outputLabel>                    
                        <apex:outputField id="Accountname2" value="{!FromACN.Name}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel >ACN</apex:outputLabel>
                        <apex:outputField id="ACNno2" value="{!FromACN.Outlet_ACN__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel >Address</apex:outputLabel>                    
                        <apex:outputField id="address2" value="{!FromACN.ShippingStreet}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem labelTitle="Address">
                        <apex:outputLabel >City</apex:outputLabel>                    
                        <apex:outputText id="AccCity2" value="{!FromACN.ShippingCity}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel >State</apex:outputLabel>                    
                        <apex:outputText id="AccState2" value="{!FromACN.ShippingState}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel >Country</apex:outputLabel>                    
                        <apex:outputText id="Country2" value="{!FromACN.ShippingCountry}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel >Zip</apex:outputLabel>                    
                        <apex:outputText id="Zip2" value="{!FromACN.ShippingPostalCode}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem ></apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem > 
                        <apex:outputLabel >NOTE: </apex:outputLabel>
                        <apex:outputText id="note2" value="Dispenser selection is not required."></apex:outputText>
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>
            </apex:pageBlockSection>      
        </apex:pageBlock>        
    </apex:form>
</apex:page>